<!DOCTYPE html>
<html lang="tk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Altyn Asyr - Aman Hayitmuradow</title>
    <style>
        :root { --bg: #f4f4f4; --card: #ffffff; --text: #333; --main: #0056b3; }
        .night-mode { --bg: #011627; --card: #1e2a38; --text: #ffffff; --main: #003d80; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; transition: 0.5s; overflow-x: hidden; }
        #snow-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 100; }
        .container { max-width: 420px; margin: auto; padding: 15px; position: relative; z-index: 10; }
        
        .lang-bar { display: flex; justify-content: center; gap: 8px; margin-bottom: 15px; }
        .lang-btn { cursor: pointer; border: 2px solid transparent; padding: 8px; border-radius: 8px; background: var(--card); font-size: 14px; font-weight: bold; transition: 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .active-lang { border-color: #28a745 !important; }

        .profile-card { background: var(--card); padding: 20px; border-radius: 15px; text-align: center; border-top: 5px solid var(--main); box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .iban-container { position: relative; background: #eee; padding: 10px; border-radius: 8px; border: 1px solid #333; color: #000; font-family: monospace; font-weight: bold; margin-top: 10px; cursor: pointer; }
        .copy-badge { position: absolute; top: -10px; right: -5px; background: #28a745; color: white; font-size: 10px; padding: 2px 6px; border-radius: 5px; }

        .card { background: var(--card); border-radius: 15px; overflow: hidden; box-shadow: 0 5px 25px rgba(0,0,0,0.2); margin-bottom: 20px; }
        .card-header { background: var(--main); color: white; padding: 15px; text-align: center; }
        .card-body { padding: 20px; }
        
        input { width: 100%; padding: 14px; margin-bottom: 15px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 18px; box-sizing: border-box; background: #fff; color: #000; }
        .pay-btn { width: 100%; padding: 18px; background: #28a745; color: white; border: none; border-radius: 10px; font-size: 20px; font-weight: bold; cursor: pointer; }

        .admin-section { background: #333; color: #fff; padding: 15px; border-radius: 10px; margin-top: 20px; display: none; }
        .history-box { background: var(--card); padding: 15px; border-radius: 10px; margin-top: 15px; font-size: 12px; max-height: 150px; overflow-y: auto; box-shadow: inset 0 0 5px rgba(0,0,0,0.1); }
        
        #receipt-box { display: none; background: #fff; color: #000; padding: 20px; border: 2px dashed #333; border-radius: 10px; margin-top: 20px; font-family: monospace; }
        #loader { display: none; text-align: center; padding: 20px; }
        .spinner { width: 30px; height: 30px; border: 4px solid #f3f3f3; border-top: 4px solid var(--main); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body onload="initSnow(); drawSnow(); loadSettings();">

    <canvas id="snow-canvas"></canvas>

    <div class="container">
        <div class="lang-bar">
            <button class="lang-btn active-lang" id="btn-tk" onclick="changeLang('tk')">ðŸ‡¹ðŸ‡² TK</button>
            <button class="lang-btn" id="btn-ru" onclick="changeLang('ru')">ðŸ‡·ðŸ‡º RU</button>
            <button class="lang-btn" id="btn-tr" onclick="changeLang('tr')">ðŸ‡¹ðŸ‡· TR</button>
            <button class="lang-btn" id="btn-en" onclick="changeLang('en')">ðŸ‡ºðŸ‡¸ EN</button>
        </div>

        <div class="profile-card">
            <h2 style="margin:0;">Hayitmuradow Aman</h2>
            <div class="iban-container" onclick="copyIban()">
                <span id="iban-text">TR15 0015 7000 0000 0201 4581 78</span>
                <span class="copy-badge">COPY</span>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h2 id="title-as">ALTYN ASYR</h2></div>
            <div class="card-body">
                <input type="tel" value="+993 6" id="phone">
                <input type="number" id="tmt_input" placeholder="0.00 TMT" oninput="calculate()">
                <div id="calc-res" style="text-align:center; font-weight:bold; color:#0056b3; margin-bottom:15px; font-size:26px;">0.00 TL</div>
                <button class="pay-btn" id="pay-btn" onclick="processPayment()">TÃ–LEG ET</button>
                
                <div id="loader"><div class="spinner"></div><p id="loading-text">...</p></div>
                <div id="receipt-box">
                    <h3 id="rc-title" style="text-align:center;">Ã‡EK</h3>
                    <div id="receipt-details"></div>
                </div>
            </div>
        </div>

        <div class="history-box">
            <b>GeÃ§miÅŸ:</b>
            <div id="history-list">TÃ¶leg Ã½ok.</div>
        </div>

        <button onclick="toggleAdmin()" style="margin-top:20px; background:none; border:none; color:gray; font-size:10px; cursor:pointer;">Admin</button>
        <div class="admin-section" id="admin-panel">
            Kurs: <input type="number" id="rate-input" step="0.1" value="10.5" style="width:80px; padding:5px;">
            <button onclick="saveSettings()">OK</button>
        </div>
    </div>

    <script>
        let currentRate = 10.5;
        let currentLang = 'tk';
        const langs = {
            tk: { pay: "TÃ–LEG ET", receipt: "TÃ–LEG Ã‡EKI", alert: "Mukdary giriziÅˆ!", copied: "GÃ¶Ã§Ã¼rildi!" },
            ru: { pay: "ÐžÐŸÐ›ÐÐ¢Ð˜Ð¢Ð¬", receipt: "Ð§Ð•Ðš ÐžÐŸÐ›ÐÐ¢Ð«", alert: "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑÑƒÐ¼Ð¼Ñƒ!", copied: "Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾!" },
            tr: { pay: "Ã–DEME YAP", receipt: "Ã–DEME FÄ°ÅžÄ°", alert: "MiktarÄ± giriniz!", copied: "KopyalandÄ±!" },
            en: { pay: "PAY NOW", receipt: "RECEIPT", alert: "Enter amount!", copied: "Copied!" }
        };

        function calculate() {
            let tmt = document.getElementById('tmt_input').value;
            let tl = (tmt * currentRate).toFixed(2);
            document.getElementById('calc-res').innerText = (tmt > 0 ? tl : "0.00") + " TL";
        }

        function copyIban() {
            const iban = document.getElementById('iban-text').innerText;
            navigator.clipboard.writeText(iban).then(() => {
                alert(langs[currentLang].copied);
            });
        }

        function toggleAdmin() {
            let pass = prompt("Parol:");
            if(pass === "1234") document.getElementById('admin-panel').style.display = "block";
        }

        function saveSettings() {
            currentRate = document.getElementById('rate-input').value;
            localStorage.setItem('rate', currentRate);
            alert("Kurs tÃ¤zelendi!");
            calculate();
        }

        function loadSettings() {
            let savedRate = localStorage.getItem('rate');
            if(savedRate) {
                currentRate = parseFloat(savedRate);
                document.getElementById('rate-input').value = savedRate;
            }
            loadHistory();
        }

        function processPayment() {
            const tmt = document.getElementById('tmt_input').value;
            if(!tmt || tmt <= 0) { alert(langs[currentLang].alert); return; }

            document.getElementById('pay-btn').style.display = "none";
            document.getElementById('loader').style.display = "block";

            setTimeout(() => {
                const phone = document.getElementById('phone').value;
                const tl = (tmt * currentRate).toFixed(2);
                const id = Math.floor(Math.random() * 900000) + 100000;
                const date = new Date().toLocaleString();

                document.getElementById('loader').style.display = "none";
                document.getElementById('receipt-box').style.display = "block";
                document.getElementById('receipt-details').innerHTML = `ID: #${id}<br>Tel: ${phone}<br>TMT: ${tmt}<br>TL: ${tl}<br>${date}`;

                let history = JSON.parse(localStorage.getItem('history') || "[]");
                history.unshift(`${date}: ${tmt} TMT -> ${tl} TL`);
                localStorage.setItem('history', JSON.stringify(history.slice(0, 5)));
                loadHistory();

                window.location.href = `https://wa.me/99364041065?text=ðŸ§¾ *TÃ–LEG*%0AðŸ“ž ${phone}%0AðŸ’° ${tmt} TMT%0AðŸ’µ ${tl} TL%0AðŸ†” ${id}`;
            }, 1500);
        }

        function loadHistory() {
            let history = JSON.parse(localStorage.getItem('history') || "[]");
            document.getElementById('history-list').innerHTML = history.length > 0 ? history.join('<br>') : "TÃ¶leg Ã½ok.";
        }

        function changeLang(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active-lang'));
            document.getElementById('btn-'+lang).classList.add('active-lang');
            document.getElementById('pay-btn').innerText = langs[lang].pay;
        }

        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let p = [];
        function initSnow() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            p = [];
            for(let i=0; i<40; i++) p.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, r:Math.random()*2+1, v:Math.random()*0.5+0.5});
        }
        function drawSnow() {
            ctx.clearRect(0,0,canvas.width,canvas.height); ctx.fillStyle="white"; ctx.beginPath();
            p.forEach(s => { ctx.moveTo(s.x, s.y); ctx.arc(s.x, s.y, s.r, 0, Math.PI*2); s.y+=s.v; if(s.y>canvas.height) s.y=-10; });
            ctx.fill(); requestAnimationFrame(drawSnow);
        }
        window.onresize = initSnow;
    </script>
</body>
</html>
